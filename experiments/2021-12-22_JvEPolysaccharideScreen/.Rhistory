library(tidyverse)
rm(list=ls())
# Set wd to parent experiment folder
setwd("~/Dropbox/projects/fmt/experiments/2021-03-18_JxE_FMT03/")
# Load Data
meta <- read_csv("metadata/samples.csv")
tax <- read_csv("data/tax.csv")
zotu <- read_csv("data/zotu.csv")
# Make tidy
zotu <- zotu %>%
pivot_longer(!seqid, names_to = "OTU", values_to = "read_count")
# Need to figure out spike-in strain, Sporosarcina, Otu id's
sporo.OTUs <- tax %>%
filter(genus == "Sporosarcina") %>%
select(OTU) %>%
as_vector()
sporo.OTUs
# Compute sporo values to normalize by for abs abd
sporo.norm <- zotu %>%
filter(OTU %in% sporo.OTUs) %>%
group_by(seqid) %>%
summarise(sporo_read_count = sum(read_count))
sporo.OTUs
# Set wd to parent experiment folder
setwd("~/Dropbox/projects/fmt/experiments/2021-03-18_JxE_FMT03/")
# Load Data
meta <- read_csv("metadata/samples.csv")
tax <- read_csv("data/tax.csv")
zotu <- read_csv("data/zotu.csv")
# Make tidy
zotu <- zotu %>%
pivot_longer(!seqid, names_to = "OTU", values_to = "read_count")
# Need to figure out spike-in strain, Sporosarcina, Otu id's
sporo.OTUs <- tax %>%
filter(genus == "Sporosarcina") %>%
select(OTU) %>%
as_vector()
sporo.OTUs
# Clean up env
rm(list =ls())
# set wd to the experiment folder
setwd("~/Dropbox/projects/fmt/experiments/2021-12-22_JvEPolysaccharideScreen/")
# Load data sets
zotu <- read_csv("data/zotu.csv")
tax <- read_csv("data/tax.csv")
meta <- read_csv("metadata/metadata.csv")
# Covert zotu into tidy format
tidy.zotu <- zotu %>%
pivot_longer(-seqid, names_to = "ZOTU", values_to = "count")
# Pull out list of spike in ZOTUs
spike.in <- tax %>%
filter(genus == "Sporosarcina") %>%
select(OTU) %>%
as_vector()
