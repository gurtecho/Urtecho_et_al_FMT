install.packages("tidyverse")
install.packages(c("nycflights13", "gapminder", "Lahman"))
library(tidyverse)
mpg
glimpse(mpg)
# mpg is a dataset within the ggplot2 package
# Contains several variables describing
mpg
mpg %>%
ggplot() +                # mpg passed as data
geom_point(aes(x=displ, y=hwy))  # displ describes engine size in L
mpg %>%
ggplot()
mpg %>%
ggplot() +
geom_point(aes(x=displ, y=hwy))
# mpg is a dataset within the ggplot2 package
# Contains several variables describing individual cars by make/model/year
mpg
# Generate a scatter plot with
# X-axis : displ - size of engine in Liters
# Y-axis : hwy - miles/gallon on the highway
mpg %>%
ggplot() +
geom_point(aes(x=displ, y=hwy))
# exercises 3.2.4
# 1. - ggplot(data) produces an empty plot
ggplot(data = mpg)
# 2. mpg contains rows and columns
ndim(mpg)
# 2. mpg contains rows and columns
dim(mpg)
# 3. the drive variable contains
?mpg
# 4. Scatterplot of hwy vs cyl
ggplot(data = mpg) +
geom_point(mapping = aes(x = hwy, y = cyl))
# 4. Scatterplot of hwy vs cyl
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy))
# 5. Scatterplot of class vs drv is not useful - drive is a categorical var,
#    not a continuous one
ggplot(data = mpg) +
geom_point(mapping = aes(x = class, y = drive))
# 5. Scatterplot of class vs drv is not useful - drive is a categorical var,
#    not a continuous one
ggplot(data = mpg) +
geom_point(mapping = aes(x = class, y = drv))
# Adding other information that maps onto the appearance of a datapoint
# in this case, mapping the color of a point to its class "level"
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy, color = class))
# Adding other information that maps onto the appearance of a datapoint
# in this case, mapping the color (a given "level") of a point to its class
# "value." Notice that there are a set of vehicles who fall outside the general
# visual linear trend in the data, and that adding in the class information as a
# visual level helps use to generate a hypothesis about these outliers!
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy, color = class))
# You can also assign a specific level to your function call to change the
# appearance in a way that's not tied to the data, i.e. without mapping
# This is done outside the mapping = aes()
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy), shape=22)
# 3.3.1 Excercises
# 1. This will produce a scatter plot with red points! This is because within
#    aes, all variables are being assigned a color as a level associated with
#    the data value "blue", as if there were a column called arbitrary_var
#    and every row contains the string "blue".
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy, color = "blue"))
# 2. Categorial ->
#    Continuous ->
?mpg
mpg
# 3. Map a continuous variable to color, size, and shape
ggplot(data = mpg) +
geom_point(aes(x = displ, y = cyl, color = cty))
# 3. Map a continuous variable to color, size, and shape
ggplot(data = mpg) +
geom_point(aes(x = displ, y = cyl, color = cty, size = hwy))
# 4. What happens if you map the same variable to multiple aesthetics?
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = cyl, color = cyl, size = cyl))
# 5. What does the stroke aesthetic do?
?geom_point
ggplot(data = mpg) +
geom_scatter(mapping = aes(x = cyl, y = hwy, stroke = class))
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy, stroke = class))
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy, stroke = cty))
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy, stroke = model))
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy, stroke = displ))
# 6. What happens if you map an aesthetic to something other than a variable
#    name, like aes(colour = displ < 5)?
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy, color = displ < 5))
# 6. What happens if you map an aesthetic to something other than a variable
#    name, like aes(colour = displ < 5)? -> Maps onto the resulting boolean!
mpg$displ < 5
# Faceting data
# Use facet_wrap for a single variable faceting, feed it a "forumula" -> ~
# Needs to be a categorial variable you facet against
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(~ class)
# Faceting data
# Use facet_wrap for a single variable faceting, feed it a "forumula" -> ~
# Needs to be a categorial variable you facet against
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(class ~)
# Faceting data
# Use facet_wrap for a single variable faceting, feed it a "forumula" -> ~
# Needs to be a categorial variable you facet against
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(class ~ .)
# Faceting data
# Use facet_wrap for a single variable faceting, feed it a "formula" -> ~
# Needs to be a categorial variable you facet against
# TODO : Figure out what formulas are?
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(~ class)
# Faceting data
# Use facet_wrap for a single variable faceting, feed it a "formula" -> ~
# Needs to be a categorial variable you facet against
# TODO : Figure out what formulas are?
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(~ class, nrow = 2)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(manufacturer ~ model)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(model ~ manufacturer)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(trans ~ drive)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(trans ~ drive)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(trans ~ drv)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(drv ~ .)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(. ~ drv)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(drv ~ .)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(drv ~ fl)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(drv ~ fl)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(fl ~ drv)
mpg
# 3.5.1 Exercises
# 1. What happens if you facet on a continuous variable?
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(. ~ cty)
# 3.5.1 Exercises
# 1. What happens if you facet on a continuous variable?
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(. ~ displ)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(fl ~ drv)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(drv ~ cyl)
avg.viz <- avg.data  %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600, color=sample_type)) +
facet_grid(polysacc) +
xlab("Time (mins)") +
labs(color="Replicate") +
theme(
axis.title.x = element_text(size = 18),
axis.text.x = element_text(size=16),
axis.title.y = element_text(size = 18),
axis.text.y = element_text(size=16),
legend.title = element_text(size=18),
legend.text = element_text(size=16),
strip.text.x = element_text(size=12),
strip.text.y = element_text(size=12),
strip.text.y.right = element_text(angle = 0))
avg.viz
library(tidyverse)
rm(list=ls())
# Working directory for the experiment
setwd("~/Dropbox/projects/fmt/experiments/2021-04-12_polysacc_growth_kinetics2/")
#  Load the metadata
meta <- read_csv("metadata/metadata.csv")
# Load the tidy OD600 data processed w/ python script
data <- read_csv("data/data.csv")
# filter the data to those wells in the metadata
data <- data %>%
filter(well %in% meta$well)
# Add the metadata to each entry
data <- data %>%
left_join(meta, by="well")
# Compute the bg from the OD600 of the water wells
bg <- data %>%
filter(polysacc == "Water") %>%
group_by(time_mins, sample_type, sample_dilution) %>%
summarise(bg = mean(OD600))
# Add bg data to the actual data
# Remove water rows
data <- data %>%
left_join(bg, by=c("time_mins", "sample_type", "sample_dilution"))
# Compute OD600 normalized against water controls
data$norm_OD600 <- data$OD600 / data$bg
# Compute the OD600 corrected against water controls
data$corr_OD600 <- data$OD600 - data$bg
data
# convert sample type to factor which levels fixed in order I want to plot
data$sample_type = factor(data$sample_type, levels = c("Jax", "Envigo"))
# Order I want to plot polysacc in, to be used as levels
polysacc.order <-c("Water", "Arabinan", "Arabinogalactan", "A_Cellulose", "Cellulose",
"Dextran", "Mucin", "Pectic Galactan", "Pectin", "MCF")
# convert polysacc to factor, levels in order I want to plot
data$polysacc <- factor(data$polysacc, levels = polysacc.order)
data$replicate <- factor(data$replicate, levels=as.character(unique(data$replicate)))
# Create averaged out data
avg.data <- data %>%
group_by(polysacc, sample_type, time_mins) %>%
summarise(OD600 = mean(OD600), bg= mean(bg))
# Compute OD600 normalized against water controls
avg.data$norm_OD600 <- avg.data$OD600 / avg.data$bg
# Compute the OD600 corrected against water controls
avg.data$corr_OD600 <- avg.data$OD600 - avg.data$bg
# Plot out avg data w/ Jax vs. Envigo together
grouped.avg.viz <- avg.data  %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600, color=sample_type)) +
facet_grid(polysacc) +
xlab("Time (mins)") +
labs(color="Replicate") +
theme(
axis.title.x = element_text(size = 18),
axis.text.x = element_text(size=16),
axis.title.y = element_text(size = 18),
axis.text.y = element_text(size=16),
legend.title = element_text(size=18),
legend.text = element_text(size=16),
strip.text.x = element_text(size=12),
strip.text.y = element_text(size=12),
strip.text.y.right = element_text(angle = 0))
grouped.avg.viz
avg.data
# Plot out avg data w/ Jax vs. Envigo together
grouped.avg.viz <- avg.data  %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600, color=sample_type)) +
facet_grid(polysacc~.) +
xlab("Time (mins)") +
labs(color="Replicate") +
theme(
axis.title.x = element_text(size = 18),
axis.text.x = element_text(size=16),
axis.title.y = element_text(size = 18),
axis.text.y = element_text(size=16),
legend.title = element_text(size=18),
legend.text = element_text(size=16),
strip.text.x = element_text(size=12),
strip.text.y = element_text(size=12),
strip.text.y.right = element_text(angle = 0))
grouped.avg.viz
# Plot out avg data w/ Jax vs. Envigo together
grouped.avg.viz <- avg.data  %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600, color=sample_type)) +
facet_grid(polysacc~.) +
xlab("Time (mins)") +
labs(color="Mouse Type") +
theme(
axis.title.x = element_text(size = 18),
axis.text.x = element_text(size=16),
axis.title.y = element_text(size = 18),
axis.text.y = element_text(size=16),
legend.title = element_text(size=18),
legend.text = element_text(size=16),
strip.text.x = element_text(size=12),
strip.text.y = element_text(size=12),
strip.text.y.right = element_text(angle = 0))
grouped.avg.viz
grouped.avg.viz
ggsave("./figures/grouped_avg_data_lineplot.svg", avg.viz)
ggsave("./figures/grouped_avg_data_lineplot.pdf", avg.viz, width=8, height=10)
ggsave("./figures/grouped_avg_data_lineplot.pdf", grouped.avg.viz, width=8, height=10)
ggsave("./figures/grouped_avg_data_lineplot.svg", grouped.avg.viz)
ggsave("./figures/grouped_avg_data_lineplot.pdf", grouped.avg.viz, width=8, height=10)
