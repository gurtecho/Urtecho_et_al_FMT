install.packages("tidyverse")
install.packages(c("nycflights13", "gapminder", "Lahman"))
library(tidyverse)
mpg
glimpse(mpg)
# mpg is a dataset within the ggplot2 package
# Contains several variables describing
mpg
mpg %>%
ggplot() +                # mpg passed as data
geom_point(aes(x=displ, y=hwy))  # displ describes engine size in L
mpg %>%
ggplot()
mpg %>%
ggplot() +
geom_point(aes(x=displ, y=hwy))
# mpg is a dataset within the ggplot2 package
# Contains several variables describing individual cars by make/model/year
mpg
# Generate a scatter plot with
# X-axis : displ - size of engine in Liters
# Y-axis : hwy - miles/gallon on the highway
mpg %>%
ggplot() +
geom_point(aes(x=displ, y=hwy))
# exercises 3.2.4
# 1. - ggplot(data) produces an empty plot
ggplot(data = mpg)
# 2. mpg contains rows and columns
ndim(mpg)
# 2. mpg contains rows and columns
dim(mpg)
# 3. the drive variable contains
?mpg
# 4. Scatterplot of hwy vs cyl
ggplot(data = mpg) +
geom_point(mapping = aes(x = hwy, y = cyl))
# 4. Scatterplot of hwy vs cyl
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy))
# 5. Scatterplot of class vs drv is not useful - drive is a categorical var,
#    not a continuous one
ggplot(data = mpg) +
geom_point(mapping = aes(x = class, y = drive))
# 5. Scatterplot of class vs drv is not useful - drive is a categorical var,
#    not a continuous one
ggplot(data = mpg) +
geom_point(mapping = aes(x = class, y = drv))
# Adding other information that maps onto the appearance of a datapoint
# in this case, mapping the color of a point to its class "level"
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy, color = class))
# Adding other information that maps onto the appearance of a datapoint
# in this case, mapping the color (a given "level") of a point to its class
# "value." Notice that there are a set of vehicles who fall outside the general
# visual linear trend in the data, and that adding in the class information as a
# visual level helps use to generate a hypothesis about these outliers!
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy, color = class))
# You can also assign a specific level to your function call to change the
# appearance in a way that's not tied to the data, i.e. without mapping
# This is done outside the mapping = aes()
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy), shape=22)
# 3.3.1 Excercises
# 1. This will produce a scatter plot with red points! This is because within
#    aes, all variables are being assigned a color as a level associated with
#    the data value "blue", as if there were a column called arbitrary_var
#    and every row contains the string "blue".
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy, color = "blue"))
# 2. Categorial ->
#    Continuous ->
?mpg
mpg
# 3. Map a continuous variable to color, size, and shape
ggplot(data = mpg) +
geom_point(aes(x = displ, y = cyl, color = cty))
# 3. Map a continuous variable to color, size, and shape
ggplot(data = mpg) +
geom_point(aes(x = displ, y = cyl, color = cty, size = hwy))
# 4. What happens if you map the same variable to multiple aesthetics?
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = cyl, color = cyl, size = cyl))
# 5. What does the stroke aesthetic do?
?geom_point
ggplot(data = mpg) +
geom_scatter(mapping = aes(x = cyl, y = hwy, stroke = class))
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy, stroke = class))
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy, stroke = cty))
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy, stroke = model))
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy, stroke = displ))
# 6. What happens if you map an aesthetic to something other than a variable
#    name, like aes(colour = displ < 5)?
ggplot(data = mpg) +
geom_point(mapping = aes(x = cyl, y = hwy, color = displ < 5))
# 6. What happens if you map an aesthetic to something other than a variable
#    name, like aes(colour = displ < 5)? -> Maps onto the resulting boolean!
mpg$displ < 5
# Faceting data
# Use facet_wrap for a single variable faceting, feed it a "forumula" -> ~
# Needs to be a categorial variable you facet against
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(~ class)
# Faceting data
# Use facet_wrap for a single variable faceting, feed it a "forumula" -> ~
# Needs to be a categorial variable you facet against
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(class ~)
# Faceting data
# Use facet_wrap for a single variable faceting, feed it a "forumula" -> ~
# Needs to be a categorial variable you facet against
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(class ~ .)
# Faceting data
# Use facet_wrap for a single variable faceting, feed it a "formula" -> ~
# Needs to be a categorial variable you facet against
# TODO : Figure out what formulas are?
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(~ class)
# Faceting data
# Use facet_wrap for a single variable faceting, feed it a "formula" -> ~
# Needs to be a categorial variable you facet against
# TODO : Figure out what formulas are?
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(~ class, nrow = 2)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(manufacturer ~ model)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(model ~ manufacturer)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(trans ~ drive)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(trans ~ drive)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(trans ~ drv)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(drv ~ .)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(. ~ drv)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(drv ~ .)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_wrap(drv ~ fl)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(drv ~ fl)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(fl ~ drv)
mpg
# 3.5.1 Exercises
# 1. What happens if you facet on a continuous variable?
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(. ~ cty)
# 3.5.1 Exercises
# 1. What happens if you facet on a continuous variable?
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(. ~ displ)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(fl ~ drv)
# Use facet_grid to facet alongside two variables
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) +
facet_grid(drv ~ cyl)
library(tidyverse)
setwd("~/Dropbox/projects/fmt/experiments/2021-04-06_polysacc_growth_kinetics/")
#  Load the metadata
meta <- read_csv("../me ")
# Working directory for the experiment
setwd("~/Dropbox/projects/fmt/experiments/2021-04-06_polysacc_growth_kinetics/")
#  Load the metadata
meta <- read_csv("metadata/metadata.csv")
# Load the tidy OD600 data processed w/ python script
data <- read_csv("data/data.csv")
data
data %>%
left_join(meta)
View(meta)
data %>%
left_join(meta, by="well")
data %>%
filter(well %in% meta$well)
# filter the data to those wells in the metadata
data <- data %>%
filter(well %in% meta$well)
data %>%
left_join(meta, by="well")
data
# Add the metadata to each entry
data <- data %>%
left_join(meta, by="well")
data
data %>%
filter(polysacc == "water")
data %>%
filter(polysacc == "water") %>%
group_by(time_mins, sample_type, sample_dilution)
data %>%
filter(polysacc == "water") %>%
group_by(time_mins, sample_type, sample_dilution) %>%
mean(OD600)
data %>%
filter(polysacc == "water") %>%
group_by(time_mins, sample_type, sample_dilution) %>%
summarise(bg = mean(OD600))
# Compute the bg from the OD600 of the water wells
bg <- data %>%
filter(polysacc == "water") %>%
group_by(time_mins, sample_type, sample_dilution) %>%
summarise(bg = mean(OD600))
data
bg
data %>%
join(bg, by=c("time_mins", "sample_type", "sample_dilution"))
data %>%
left_join(bg, by=c("time_mins", "sample_type", "sample_dilution"))
# Add bg data to the actual data
data %>%
left_join(bg, by=c("time_mins", "sample_type", "sample_dilution"))
# Add bg data to the actual data
# Remove water rows
data <- data %>%
left_join(bg, by=c("time_mins", "sample_type", "sample_dilution")) %>%
filter(polysacc != "water")
data
# Compute OD600 normalized against water controls
data$norm_OD600 <- data$OD600 / data$bg
# Compute the OD600 corrected against water controls
data$corr_OD600 <- data$OD600 / data$bg
data
library(tidyverse)
# Working directory for the experiment
setwd("~/Dropbox/projects/fmt/experiments/2021-04-06_polysacc_growth_kinetics/")
#  Load the metadata
meta <- read_csv("metadata/metadata.csv")
# Load the tidy OD600 data processed w/ python script
data <- read_csv("data/data.csv")
# filter the data to those wells in the metadata
data <- data %>%
filter(well %in% meta$well)
# Add the metadata to each entry
data <- data %>%
left_join(meta, by="well")
# Compute the bg from the OD600 of the water wells
bg <- data %>%
filter(polysacc == "water") %>%
group_by(time_mins, sample_type, sample_dilution) %>%
summarise(bg = mean(OD600))
# Add bg data to the actual data
# Remove water rows
data <- data %>%
left_join(bg, by=c("time_mins", "sample_type", "sample_dilution")) %>%
filter(polysacc != "water")
# Compute OD600 normalized against water controls
data$norm_OD600 <- data$OD600 / data$bg
# Compute the OD600 corrected against water controls
data$corr_OD600 <- data$OD600 - data$bg
data
data
# Plot raw data
data %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600))
# Plot raw data
data %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600, color=polysacc))
# Plot raw data
data %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600, color=polysacc)) +
facet_grid(.~sample_dilution)
# Plot raw data
data %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600, color=polysacc)) +
facet_grid(sample_type~sample_dilution)
# Working directory for the experiment
setwd("~/Dropbox/projects/fmt/experiments/2021-04-06_polysacc_growth_kinetics/")
#  Load the metadata
meta <- read_csv("metadata/metadata.csv")
# Load the tidy OD600 data processed w/ python script
data <- read_csv("data/data.csv")
# filter the data to those wells in the metadata
data <- data %>%
filter(well %in% meta$well)
# Add the metadata to each entry
data <- data %>%
left_join(meta, by="well")
# Compute the bg from the OD600 of the water wells
bg <- data %>%
filter(polysacc == "water") %>%
group_by(time_mins, sample_type, sample_dilution) %>%
summarise(bg = mean(OD600))
# Add bg data to the actual data
# Remove water rows
data <- data %>%
left_join(bg, by=c("time_mins", "sample_type", "sample_dilution"))
# Compute OD600 normalized against water controls
data$norm_OD600 <- data$OD600 / data$bg
# Compute the OD600 corrected against water controls
data$corr_OD600 <- data$OD600 - data$bg
# Plot raw data
data  %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600, color=polysacc)) +
facet_grid(sample_type~sample_dilution)
# Plot normalized data
data  %>%
filter(polysacc != "water") %>%
ggplot() +
geom_line(aes(x=time_mins, y=norm_OD600, color=polysacc)) +
facet_grid(sample_type~sample_dilution)
# Plot raw data
raw.viz <- data  %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600, color=polysacc)) +
facet_grid(sample_type~sample_dilution)
# Plot normalized data
norm.viz <- data  %>%
filter(polysacc != "water") %>%
ggplot() +
geom_line(aes(x=time_mins, y=norm_OD600, color=polysacc)) +
facet_grid(sample_type~sample_dilution)
# Plot raw data
raw.viz <- data  %>%
ggplot() +
geom_line(aes(x=time_mins, y=OD600, color=polysacc)) +
facet_grid(sample_type~sample_dilution) +
xlab("Time (mins)")
raw.viz
# Plot normalized data
norm.viz <- data  %>%
filter(polysacc != "water") %>%
ggplot() +
geom_line(aes(x=time_mins, y=norm_OD600, color=polysacc)) +
facet_grid(sample_type~sample_dilution) +
xlab("Time (mins)")
norm.viz
ggsave("./figures/raw_data_lineplot.svg", raw.viz)
ggsave("./figures/norm_data_lineplot.svg", norm.viz)
norm.viz
